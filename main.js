!function(){"use strict";class e{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popup.classList.add("popup_open"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keyup",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()}))}}class t extends e{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".form"),this._inputs=[...this._form.querySelectorAll(".form__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e,t,n){s(this,"_handleDelete",(()=>{this._elementContent.remove(),this._elementContent=null})),s(this,"_handleLike",(()=>{this._likeButton.classList.toggle("element__button_liked")})),s(this,"_addEventListeners",(()=>{this._elementImage.addEventListener("click",(()=>this._handeImageClick(this._data))),this._deleteButton.addEventListener("click",this._handleDelete),this._likeButton.addEventListener("click",this._handleLike)})),s(this,"_getElement",(()=>this._elementTemplate.querySelector(".element").cloneNode(!0))),this._elementTemplate=document.querySelector(t).content,this._data=e,this._handeImageClick=n}createElement(){return this._elementContent=this._getElement(),this._elementContent.querySelector(".element__name").textContent=this._data.name,this._likeButton=this._elementContent.querySelector(".element__like-button"),this._elementImage=this._elementContent.querySelector(".element__image"),this._deleteButton=this._elementContent.querySelector(".element__delete-button"),this._elementImage.src=this._data.link,this._elementImage.alt="Picture of ".concat(this._data.name),this._addEventListeners(),this._elementContent}}function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class o{constructor(e,t){i(this,"_toggleInputError",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e)})),i(this,"_showInputError",(e=>{const t=this._formElement.querySelector("#"+e.id+"-error");e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)})),i(this,"_hideInputError",(e=>{const t=this._formElement.querySelector("#"+e.id+"-error");e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)})),i(this,"_enableButton",(()=>{this._submitButton.disabled=!1,this._submitButton.classList.remove(this._settings.inactiveButtonClass)})),i(this,"disableButton",(()=>{this._submitButton.disabled=!0,this._submitButton.classList.add(this._settings.inactiveButtonClass)})),i(this,"_toggleButton",(()=>{this._hasValidInputs()?this._enableButton():this.disableButton()})),i(this,"_hasValidInputs",(()=>this._inputList.every((e=>!0===e.validity.valid)))),this._settings=e,this._formElement=t,this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._toggleInputError(e),this._toggleButton()}))}))}resetValidation(){this._toggleButton(),this._inputList.forEach(this._hideInputError)}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r=document.querySelector(".profile__edit-button"),l=document.querySelector(".form__input"),a=document.querySelector(".form__input:last-of-type"),_=document.querySelector(".form_type_profile"),u=(document.querySelector(".elements").querySelector(".elements__list"),document.querySelector(".profile__add-button")),c=document.querySelector(".form_type_add-place"),h={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},d=e=>{const t=new n(s=e,"#element-template",(()=>{f.open(s.name,s.link)})).createElement();var s;y.addItem(t)},m=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._name=document.querySelector(t),this._job=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}setUserInfo(e){let{fullName:t,className:s}=e;this._name.textContent=t,this._job.textContent=s}}({nameSelector:".profile__info-title",jobSelector:".profile__info-class"}),p=new t(".popup_type_add-place",(e=>{d({name:e["card-title"],link:e["card-link"]}),p.close()})),b=new t(".popup_type_edit-profile",(e=>{m.setUserInfo(e),b.close()}));b.setEventListeners(),p.setEventListeners();const g=new o(h,_),E=new o(h,c),f=new class extends e{constructor(e){super(e),this._caption=this._popup.querySelector(".popup__caption"),this._image=this._popup.querySelector(".popup__image")}open(e,t){super.open(),this._caption.textContent=e,this._image.src=t,this._image.alt="Photo of ".concat(e)}}(".popup_type_image-preview");f.setEventListeners();const y=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:d},".elements__list");y.renderItems(),r.addEventListener("click",(()=>{(()=>{const e=m.getUserInfo();l.value=e.name,a.value=e.job})(),b.open()})),g.enableValidation(),E.enableValidation(),u.addEventListener("click",(()=>{p.open(),E.resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sTUFBTUEsRUFDWEMsWUFBWUMsR0FDVkMsS0FBS0MsT0FBU0MsU0FBU0MsY0FBY0osR0FDckNDLEtBQUtJLGdCQUFrQkosS0FBS0ksZ0JBQWdCQyxLQUFLTCxLQUNsRCxDQUVESSxnQkFBZ0JFLEdBQ0UsV0FBWkEsRUFBSUMsS0FDTlAsS0FBS1EsT0FFUixDQUVEQyxPQUNFVCxLQUFLQyxPQUFPUyxVQUFVQyxJQUFJLGNBQzFCVCxTQUFTVSxpQkFBaUIsUUFBU1osS0FBS0ksZ0JBQ3pDLENBRURJLFFBQ0VSLEtBQUtDLE9BQU9TLFVBQVVHLE9BQU8sY0FDN0JYLFNBQVNZLG9CQUFvQixRQUFTZCxLQUFLSSxnQkFDNUMsQ0FFRFcsb0JBQ0VmLEtBQUtDLE9BQU9XLGlCQUFpQixhQUFjTixLQUV2Q0EsRUFBSVUsT0FBT04sVUFBVU8sU0FBUyxVQUM5QlgsRUFBSVUsT0FBT04sVUFBVU8sU0FBUyx5QkFFOUJqQixLQUFLUSxPQUNOLEdBRUosRUM3QkksTUFBTVUsVUFBc0JyQixFQUNqQ0MsWUFBWUMsRUFBZW9CLEdBQ3pCQyxNQUFNckIsR0FDTkMsS0FBS3FCLGNBQWdCRixFQUNyQm5CLEtBQUtzQixNQUFRdEIsS0FBS0MsT0FBT0UsY0FBYyxTQUN2Q0gsS0FBS3VCLFFBQVUsSUFBSXZCLEtBQUtzQixNQUFNRSxpQkFBaUIsZ0JBQ2hELENBRURDLGtCQUNFLE1BQU1DLEVBQVMsQ0FBQyxFQUloQixPQUhBMUIsS0FBS3VCLFFBQVFJLFNBQVNDLElBQ3BCRixFQUFPRSxFQUFNQyxNQUFRRCxFQUFNRSxLQUEzQixJQUVLSixDQUNSLENBRURYLG9CQUNFSyxNQUFNTCxvQkFDTmYsS0FBS3NCLE1BQU1WLGlCQUFpQixVQUFXbUIsSUFDckNBLEVBQUVDLGlCQUNGaEMsS0FBS3FCLGNBQWNyQixLQUFLeUIsa0JBQXhCLEdBRUgsQ0FFRGpCLFFBQ0VZLE1BQU1aLFFBQ05SLEtBQUtzQixNQUFNVyxPQUNaLEUsd0hDN0JJLE1BQU1DLEVBQ1hwQyxZQUFZcUMsRUFBTUMsRUFBc0JDLEdBQWtCLHdCQU8xQyxLQUNkckMsS0FBS3NDLGdCQUFnQnpCLFNBQ3JCYixLQUFLc0MsZ0JBQWtCLElBQXZCLElBVHdELHNCQVk1QyxLQUNadEMsS0FBS3VDLFlBQVk3QixVQUFVOEIsT0FBTyx3QkFBbEMsSUFid0QsNkJBZ0JyQyxLQUNuQnhDLEtBQUt5QyxjQUFjN0IsaUJBQWlCLFNBQVMsSUFDM0NaLEtBQUswQyxpQkFBaUIxQyxLQUFLMkMsU0FFN0IzQyxLQUFLNEMsY0FBY2hDLGlCQUFpQixRQUFTWixLQUFLNkMsZUFDbEQ3QyxLQUFLdUMsWUFBWTNCLGlCQUFpQixRQUFTWixLQUFLOEMsWUFBaEQsSUFyQndELHNCQXdCNUMsSUFDSjlDLEtBQUsrQyxpQkFDVjVDLGNBQWMsWUFDZDZDLFdBQVUsS0ExQmJoRCxLQUFLK0MsaUJBQ0g3QyxTQUFTQyxjQUFjaUMsR0FBc0JhLFFBQy9DakQsS0FBSzJDLE1BQVFSLEVBQ2JuQyxLQUFLMEMsaUJBQW1CTCxDQUN6QixDQXlCRGEsZ0JBY0UsT0FiQWxELEtBQUtzQyxnQkFBa0J0QyxLQUFLbUQsY0FDUm5ELEtBQUtzQyxnQkFBZ0JuQyxjQUFjLGtCQUMzQ2lELFlBQWNwRCxLQUFLMkMsTUFBTWQsS0FDckM3QixLQUFLdUMsWUFBY3ZDLEtBQUtzQyxnQkFBZ0JuQyxjQUN0Qyx5QkFFRkgsS0FBS3lDLGNBQWdCekMsS0FBS3NDLGdCQUFnQm5DLGNBQWMsbUJBQ3hESCxLQUFLNEMsY0FBZ0I1QyxLQUFLc0MsZ0JBQWdCbkMsY0FDeEMsMkJBRUZILEtBQUt5QyxjQUFjWSxJQUFNckQsS0FBSzJDLE1BQU1XLEtBQ3BDdEQsS0FBS3lDLGNBQWNjLElBQW5CLHFCQUF1Q3ZELEtBQUsyQyxNQUFNZCxNQUNsRDdCLEtBQUt3RCxxQkFDRXhELEtBQUtzQyxlQUNiLEUsd0hDOUNJLE1BQU1tQixFQUNYM0QsWUFBWTRELEVBQVVDLEdBQWEsNEJBV2QvQixJQUNmQSxFQUFNZ0MsU0FBU0MsTUFDakI3RCxLQUFLOEQsZ0JBQWdCbEMsR0FFckI1QixLQUFLK0QsZ0JBQWdCbkMsRUFDdEIsSUFoQmdDLDBCQW1CaEJBLElBQ2pCLE1BQU1vQyxFQUFlaEUsS0FBS2lFLGFBQWE5RCxjQUNyQyxJQUFNeUIsRUFBTXNDLEdBQUssVUFFbkJ0QyxFQUFNbEIsVUFBVUMsSUFBSVgsS0FBS21FLFVBQVVDLGlCQUNuQ0osRUFBYVosWUFBY3hCLEVBQU15QyxrQkFDakNMLEVBQWF0RCxVQUFVQyxJQUFJWCxLQUFLbUUsVUFBVUcsV0FBMUMsSUF6QmlDLDBCQTRCaEIxQyxJQUNqQixNQUFNb0MsRUFBZWhFLEtBQUtpRSxhQUFhOUQsY0FDckMsSUFBTXlCLEVBQU1zQyxHQUFLLFVBRW5CdEMsRUFBTWxCLFVBQVVHLE9BQU9iLEtBQUttRSxVQUFVQyxpQkFDdENKLEVBQWFaLFlBQWMsR0FDM0JZLEVBQWF0RCxVQUFVRyxPQUFPYixLQUFLbUUsVUFBVUcsV0FBN0MsSUFsQ2lDLHdCQXFDbkIsS0FDZHRFLEtBQUt1RSxjQUFjQyxVQUFXLEVBQzlCeEUsS0FBS3VFLGNBQWM3RCxVQUFVRyxPQUFPYixLQUFLbUUsVUFBVU0sb0JBQW5ELElBdkNpQyx3QkEwQ25CLEtBQ2R6RSxLQUFLdUUsY0FBY0MsVUFBVyxFQUM5QnhFLEtBQUt1RSxjQUFjN0QsVUFBVUMsSUFBSVgsS0FBS21FLFVBQVVNLG9CQUFoRCxJQTVDaUMsd0JBK0NuQixLQUNUekUsS0FBSzBFLGtCQUdSMUUsS0FBSzJFLGdCQUZMM0UsS0FBSzRFLGVBR04sSUFwRGdDLDBCQXVEakIsSUFDVDVFLEtBQUs2RSxXQUFXQyxPQUFPbEQsSUFBbUMsSUFBekJBLEVBQU1nQyxTQUFTQyxVQXZEdkQ3RCxLQUFLbUUsVUFBWVQsRUFDakIxRCxLQUFLaUUsYUFBZU4sRUFDcEIzRCxLQUFLNkUsV0FBYSxJQUNiN0UsS0FBS2lFLGFBQWF6QyxpQkFBaUJ4QixLQUFLbUUsVUFBVVksZ0JBRXZEL0UsS0FBS3VFLGNBQWdCdkUsS0FBS2lFLGFBQWE5RCxjQUNyQ0gsS0FBS21FLFVBQVVhLHFCQUVsQixDQWlEREMscUJBQ0VqRixLQUFLNkUsV0FBV2xELFNBQVNDLElBQ3ZCQSxFQUFNaEIsaUJBQWlCLFNBQVMsS0FDOUJaLEtBQUtrRixrQkFBa0J0RCxHQUN2QjVCLEtBQUttRixlQUFMLEdBRkYsR0FLSCxDQUVEQyxrQkFDRXBGLEtBQUttRixnQkFDTG5GLEtBQUs2RSxXQUFXbEQsUUFBUTNCLEtBQUs4RCxnQkFDOUIsQ0FFRHVCLG1CQUNFckYsS0FBS2lFLGFBQWFyRCxpQkFBaUIsVUFBV21CLElBQzVDQSxFQUFFQyxnQkFBRixJQUVGaEMsS0FBS2lGLG9CQUNOLEVDdkVILE1BQU1LLEVBQW9CcEYsU0FBU0MsY0FBYyx5QkFDM0NvRixFQUFZckYsU0FBU0MsY0FBYyxnQkFDbkNxRixFQUFrQnRGLFNBQVNDLGNBQWMsNkJBQ3pDc0YsRUFBY3ZGLFNBQVNDLGNBQWMsc0JBK0JyQ3VGLEdBOUJXeEYsU0FBU0MsY0FBYyxhQUNYQSxjQUFjLG1CQTZCcEJELFNBQVNDLGNBQWMseUJBQ3hDd0YsRUFBWXpGLFNBQVNDLGNBQWMsd0JBQ25DdUQsRUFBVyxDQUNma0MsYUFBYyxRQUNkYixjQUFlLGVBQ2ZDLHFCQUFzQix3QkFDdEJQLG9CQUFxQixnQ0FDckJMLGdCQUFpQix5QkFDakJFLFdBQVksdUJBV1J1QixFQUFjQyxJQUNsQixNQUFNQyxFQVBPLElBQUk3RCxFQURDQyxFQVFhMkQsRUFUSixxQkFFdUIsS0FDaERFLEVBQWN2RixLQUFLMEIsRUFBS04sS0FBTU0sRUFBS21CLEtBQW5DLElBRVVKLGdCQUpNZixNQVNsQjhELEVBQVFDLFFBQVFILEVBQWhCLEVBVUlJLEVBQVcsSUN4RVYsTUFDTHJHLFlBQVksR0FBK0IsSUFBL0IsYUFBRXNHLEVBQUYsWUFBZ0JDLEdBQWUsRUFDekNyRyxLQUFLc0csTUFBUXBHLFNBQVNDLGNBQWNpRyxHQUNwQ3BHLEtBQUt1RyxLQUFPckcsU0FBU0MsY0FBY2tHLEVBQ3BDLENBRURHLGNBQ0UsTUFBTyxDQUNMM0UsS0FBTTdCLEtBQUtzRyxNQUFNbEQsWUFDakJxRCxJQUFLekcsS0FBS3VHLEtBQUtuRCxZQUVsQixDQUVEc0QsWUFBWSxHQUF5QixJQUF6QixTQUFFQyxFQUFGLFVBQVlDLEdBQWEsRUFDbkM1RyxLQUFLc0csTUFBTWxELFlBQWN1RCxFQUN6QjNHLEtBQUt1RyxLQUFLbkQsWUFBY3dELENBQ3pCLEdEd0QyQixDQUM1QlIsYUFBYyx1QkFDZEMsWUFBYSx5QkFRVFEsRUFBZSxJQUFJM0YsRUFDdkIseUJBbEIyQmlCLElBQzNCMEQsRUFDRSxDQUFFaEUsS0FBTU0sRUFBSyxjQUFlbUIsS0FBTW5CLEVBQUssZUFHekMwRSxFQUFhckcsT0FBYixJQWdCSXNHLEVBQW1CLElBQUk1RixFQUMzQiw0QkFWK0JpQixJQUMvQmdFLEVBQVNPLFlBQVl2RSxHQUNyQjJFLEVBQWlCdEcsT0FBakIsSUFXRnNHLEVBQWlCL0Ysb0JBRWpCOEYsRUFBYTlGLG9CQUNiLE1BQU1nRyxFQUFvQixJQUFJdEQsRUFBY0MsRUFBVStCLEdBQ2hEdUIsRUFBdUIsSUFBSXZELEVBQWNDLEVBQVVpQyxHQUVuREssRUFBZ0IsSUU5RmYsY0FBNkJuRyxFQUNsQ0MsWUFBWUMsR0FDVnFCLE1BQU1yQixHQUNOQyxLQUFLaUgsU0FBV2pILEtBQUtDLE9BQU9FLGNBQWMsbUJBQzFDSCxLQUFLa0gsT0FBU2xILEtBQUtDLE9BQU9FLGNBQWMsZ0JBQ3pDLENBRURNLEtBQUtvQixFQUFNeUIsR0FDVGxDLE1BQU1YLE9BRU5ULEtBQUtpSCxTQUFTN0QsWUFBY3ZCLEVBQzVCN0IsS0FBS2tILE9BQU83RCxJQUFNQyxFQUNsQnRELEtBQUtrSCxPQUFPM0QsSUFBWixtQkFBOEIxQixFQUMvQixHRmlGc0MsNkJBQ3pDbUUsRUFBY2pGLG9CQUVkLE1BQU1rRixFQUFVLElHbkdULE1BQ0xuRyxZQUFZLEVBQXFCcUgsR0FBZSxJQUFwQyxNQUFFQyxFQUFGLFNBQVNDLEdBQTJCLEVBQzlDckgsS0FBS3NILE9BQVNGLEVBQ2RwSCxLQUFLdUgsVUFBWUYsRUFDakJySCxLQUFLd0gsV0FBYXRILFNBQVNDLGNBQWNnSCxFQUMxQyxDQUVETSxjQUNFekgsS0FBS3NILE9BQU8zRixRQUFRM0IsS0FBS3VILFVBQzFCLENBRURyQixRQUFRd0IsR0FDTjFILEtBQUt3SCxXQUFXRyxRQUFRRCxFQUN6QixHSHVGRCxDQUFFTixNQXRGb0IsQ0FDdEIsQ0FDRXZGLEtBQU0sa0JBQ055QixLQUFNLG9EQUVSLENBQ0V6QixLQUFNLGNBQ055QixLQUFNLHVEQUVSLENBQ0V6QixLQUFNLGlCQUNOeUIsS0FBTSwwREFFUixDQUNFekIsS0FBTSxVQUNOeUIsS0FBTSxtREFFUixDQUNFekIsS0FBTSx3QkFDTnlCLEtBQU0sbURBRVIsQ0FDRXpCLEtBQU0saUJBQ055QixLQUFNLGlEQStEa0IrRCxTQUFVeEIsR0FDcEMsbUJBRUZJLEVBQVF3QixjQU9SbkMsRUFBa0IxRSxpQkFBaUIsU0FBUyxLQUxwQixNQUN0QixNQUFNZ0gsRUFBY3pCLEVBQVNLLGNBQzdCakIsRUFBVXpELE1BQVE4RixFQUFZL0YsS0FDOUIyRCxFQUFnQjFELE1BQVE4RixFQUFZbkIsR0FBcEMsRUFHQW9CLEdBQ0FmLEVBQWlCckcsTUFBakIsSUFHRnNHLEVBQWtCMUIsbUJBQ2xCMkIsRUFBcUIzQixtQkFFckJLLEVBQWU5RSxpQkFBaUIsU0FBUyxLQUN2Q2lHLEVBQWFwRyxPQUNidUcsRUFBcUI1QixpQkFBckIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3Byb2plY3Q0Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdDQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3Byb2plY3Q0Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0NC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJvamVjdDQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJvamVjdDQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcm9qZWN0NC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3Byb2plY3Q0Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpIHx8XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB2YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoZGF0YSwgY2FyZFRlbXBsYXRlU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2spIHtcclxuICAgIHRoaXMuX2VsZW1lbnRUZW1wbGF0ZSA9XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFRlbXBsYXRlU2VsZWN0b3IpLmNvbnRlbnQ7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX2hhbmRlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudENvbnRlbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50Q29udGVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUxpa2UgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50X19idXR0b25fbGlrZWRcIik7XHJcbiAgfTtcclxuXHJcbiAgX2FkZEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fZWxlbWVudEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kZUltYWdlQ2xpY2sodGhpcy5fZGF0YSlcclxuICAgICk7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZSk7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVMaWtlKTtcclxuICB9O1xyXG5cclxuICBfZ2V0RWxlbWVudCA9ICgpID0+IHtcclxuICAgIHJldHVybiAodGhpcy5fZWxlbWVudFRlbXBsYXRlXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKSk7XHJcbiAgfTtcclxuXHJcbiAgY3JlYXRlRWxlbWVudCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRDb250ZW50ID0gdGhpcy5fZ2V0RWxlbWVudCgpO1xyXG4gICAgY29uc3QgZWxlbWVudE5hbWUgPSB0aGlzLl9lbGVtZW50Q29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX25hbWVcIik7XHJcbiAgICBlbGVtZW50TmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX2RhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50Q29udGVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5lbGVtZW50X19saWtlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fZWxlbWVudEltYWdlID0gdGhpcy5fZWxlbWVudENvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnRDb250ZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLmVsZW1lbnRfX2RlbGV0ZS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2VsZW1lbnRJbWFnZS5zcmMgPSB0aGlzLl9kYXRhLmxpbms7XHJcbiAgICB0aGlzLl9lbGVtZW50SW1hZ2UuYWx0ID0gYFBpY3R1cmUgb2YgJHt0aGlzLl9kYXRhLm5hbWV9YDtcclxuICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudENvbnRlbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUlucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcclxuICAgIGlmIChpbnB1dC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIiNcIiArIGlucHV0LmlkICsgXCItZXJyb3JcIlxyXG4gICAgKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIiNcIiArIGlucHV0LmlkICsgXCItZXJyb3JcIlxyXG4gICAgKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfZW5hYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9O1xyXG5cclxuICBkaXNhYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF90b2dnbGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBpZiAoIXRoaXMuX2hhc1ZhbGlkSW5wdXRzKCkpIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfaGFzVmFsaWRJbnB1dHMgPSAoKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQgPT09IHRydWUpO1xyXG4gIH07XHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKHRoaXMuX2hpZGVJbnB1dEVycm9yKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmNvbnN0IHByb2ZpbGVPcGVuQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dFwiKTtcclxuY29uc3Qgb2NjdXBhdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dDpsYXN0LW9mLXR5cGVcIik7XHJcbmNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX3R5cGVfcHJvZmlsZVwiKTtcclxuY29uc3QgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzXCIpO1xyXG5jb25zdCBlbGVtZW50TGlzdCA9IGVsZW1lbnRzLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2xpc3RcIik7XHJcblxyXG5jb25zdCBpbml0aWFsRWxlbWVudHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuY29uc3QgYWRkUGxhY2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IHBsYWNlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV90eXBlX2FkZC1wbGFjZVwiKTtcclxuY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZVNlbGVjdG9yID0gXCIjZWxlbWVudC10ZW1wbGF0ZVwiO1xyXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgY2FyZFRlbXBsYXRlU2VsZWN0b3IsICgpID0+IHtcclxuICAgIGFkZFBvcHVwSW1hZ2Uub3BlbihkYXRhLm5hbWUsIGRhdGEubGluayk7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIGNhcmQuY3JlYXRlRWxlbWVudCgpO1xyXG59O1xyXG5cclxuY29uc3QgcmVuZGVyQ2FyZCA9IChjYXJkRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufTtcclxuXHJcbmNvbnN0IGhhbmRsZUFkZENhcmRTdWJtaXQgPSAoZGF0YSkgPT4ge1xyXG4gIHJlbmRlckNhcmQoXHJcbiAgICB7IG5hbWU6IGRhdGFbXCJjYXJkLXRpdGxlXCJdLCBsaW5rOiBkYXRhW1wiY2FyZC1saW5rXCJdIH0sXHJcbiAgICBlbGVtZW50TGlzdFxyXG4gICk7XHJcbiAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbn07XHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2luZm8tdGl0bGVcIixcclxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9faW5mby1jbGFzc1wiLFxyXG59KTtcclxuXHJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKGRhdGEpID0+IHtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcclxuICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbn07XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cF90eXBlX2FkZC1wbGFjZVwiLFxyXG4gIGhhbmRsZUFkZENhcmRTdWJtaXRcclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwX3R5cGVfZWRpdC1wcm9maWxlXCIsXHJcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXRcclxuKTtcclxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIHByb2ZpbGVGb3JtKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgcGxhY2VGb3JtKTtcclxuXHJcbmNvbnN0IGFkZFBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIucG9wdXBfdHlwZV9pbWFnZS1wcmV2aWV3XCIpO1xyXG5hZGRQb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgeyBpdGVtczogaW5pdGlhbEVsZW1lbnRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gIFwiLmVsZW1lbnRzX19saXN0XCJcclxuKTtcclxuc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuY29uc3QgZmlsbFByb2ZpbGVGb3JtID0gKCkgPT4ge1xyXG4gIGNvbnN0IHByb2ZpbGVEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5uYW1lO1xyXG4gIG9jY3VwYXRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEYXRhLmpvYjtcclxufTtcclxucHJvZmlsZU9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmaWxsUHJvZmlsZUZvcm0oKTtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmFkZFBsYWNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxuICBhZGRDYXJkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBmdWxsTmFtZSwgY2xhc3NOYW1lIH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBmdWxsTmFtZTtcclxuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGNsYXNzTmFtZTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FwdGlvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcblxyXG4gICAgdGhpcy5fY2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7bmFtZX1gO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY2xhc3NTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwicG9wdXBTZWxlY3RvciIsInRoaXMiLCJfcG9wdXAiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsIkNhcmQiLCJkYXRhIiwiY2FyZFRlbXBsYXRlU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiX2VsZW1lbnRDb250ZW50IiwiX2xpa2VCdXR0b24iLCJ0b2dnbGUiLCJfZWxlbWVudEltYWdlIiwiX2hhbmRlSW1hZ2VDbGljayIsIl9kYXRhIiwiX2RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGUiLCJfaGFuZGxlTGlrZSIsIl9lbGVtZW50VGVtcGxhdGUiLCJjbG9uZU5vZGUiLCJjb250ZW50IiwiY3JlYXRlRWxlbWVudCIsIl9nZXRFbGVtZW50IiwidGV4dENvbnRlbnQiLCJzcmMiLCJsaW5rIiwiYWx0IiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiaWQiLCJfc2V0dGluZ3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yQ2xhc3MiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2hhc1ZhbGlkSW5wdXRzIiwiX2VuYWJsZUJ1dHRvbiIsImRpc2FibGVCdXR0b24iLCJfaW5wdXRMaXN0IiwiZXZlcnkiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfdG9nZ2xlSW5wdXRFcnJvciIsIl90b2dnbGVCdXR0b24iLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwicHJvZmlsZU9wZW5CdXR0b24iLCJuYW1lSW5wdXQiLCJvY2N1cGF0aW9uSW5wdXQiLCJwcm9maWxlRm9ybSIsImFkZFBsYWNlQnV0dG9uIiwicGxhY2VGb3JtIiwiZm9ybVNlbGVjdG9yIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwiY2FyZEVsZW1lbnQiLCJhZGRQb3B1cEltYWdlIiwic2VjdGlvbiIsImFkZEl0ZW0iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWUiLCJfam9iIiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsImZ1bGxOYW1lIiwiY2xhc3NOYW1lIiwiYWRkQ2FyZFBvcHVwIiwiZWRpdFByb2ZpbGVQb3B1cCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJfY2FwdGlvbiIsIl9pbWFnZSIsImNsYXNzU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZWxlbWVudCIsInByZXBlbmQiLCJwcm9maWxlRGF0YSIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=